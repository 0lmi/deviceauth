version: '2'
services:
    acceptance:
        image: testing
        networks:
            - mender
        volumes:
            - "${TESTS_DIR}:/testing"
        depends_on:
            - mender-device-adm
            - mender-device-auth
            - mender-inventory
        # run multi tenant tests only
        command: -k TestMultiTenant
        environment:
            # fake tenantadm service will be run on port 9999
            FAKE_TENANTADM_ADDR: "0.0.0.0:9999"
    mender-device-auth:
            # built/tagged locally and only used for testing
            image: mendersoftware/deviceauth:prtest
            volumes:
                  - "${TESTS_DIR}:/testing"
            environment:
                # acceptance container will be running fake tenantadm service,
                # direct deviceauth there
                DEVICEAUTH_TENANTADM_ADDR: "http://acceptance:9999/"
